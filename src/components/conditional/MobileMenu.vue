<script setup lang="ts">
  import type { RouteRecordNormalized } from 'vue-router'
  import { showWindow, useLogout } from '@/utils'

  import ButtonMenu from '@/components/button/ButtonMenu.vue'
  import ButtonX from '@/components/button/ButtonX.vue'

  const props = defineProps<{
    loggedIn: boolean,
    menuItems: RouteRecordNormalized[],
    show: boolean
  }>()

  const emit = defineEmits<{
    (e: 'action:logout'): void
  }>()
</script>

<template>
  <transition name="menu">
    <div v-if="show" class="w-full min-h-screen max-h-full absolute top-0 bg-white flex flex-col justify-start items-start px-6 pt-6 pb-4 z-10" v-scroll-lock>
      <div class="w-full flex items-center justify-between">
        <svg width="50" height="50" viewBox="0 0 400 400" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill="currentColor" stroke-width="5" stroke="currentColor" d="M326.99,139.21c-7.96-20.34-23.65-34.07-45.36-39.72-12.67-3.29-23.81-2.94-28.35-2.59-12.6-17.38-30.83-26.5-53.33-26.5s-40.26,9.33-53.46,27.09c-.34-.18-.72-.32-1.12-.38-.56-.08-13.8-1.91-29.42,2.22-14.58,3.86-33.97,13.84-43.53,39.45-7.42,19.88-3.61,40.37,11.02,59.25,8.7,11.23,18.69,18.67,22.57,21.34v83c0,16.26,13.23,29.5,29.5,29.5h8.28c1.93,0,3.5-1.57,3.5-3.5s-1.57-3.5-3.5-3.5h-8.28c-12.4,0-22.5-10.09-22.5-22.5v-17.71h173.89v17.71c0,12.4-10.09,22.5-22.5,22.5h-91.6c-1.93,0-3.5,1.57-3.5,3.5s1.57,3.5,3.5,3.5h91.6c16.26,0,29.5-13.23,29.5-29.5v-82.93c4-2.58,14.1-9.67,22.82-20.62,14.74-18.52,18.3-39.14,10.27-59.62ZM311.36,194.31c-10.09,12.75-22.6,20.09-22.72,20.16-1.08.63-1.75,1.78-1.75,3.03v60.17H113v-60.17c0-1.21-.62-2.33-1.65-2.97-.48-.3-48.27-30.76-32.38-73.29,6.81-18.23,19.77-30.03,38.54-35.07,10.78-2.89,20.52-2.64,24.7-2.33-.54.88-1.06,1.76-1.58,2.67-9.94,17.55-12.4,34.85-12.5,35.58-.26,1.91,1.08,3.68,2.99,3.94,1.92.27,3.68-1.07,3.94-2.99.02-.17,2.42-16.87,11.75-33.26,12.23-21.48,30.1-32.38,53.12-32.38,20.98,0,37.3,8.39,48.63,24.95,0,0,.01.01.02.02,1.56,2.28,3.03,4.71,4.39,7.3,8.64,16.34,10.08,33.01,10.1,33.17.15,1.83,1.68,3.22,3.49,3.22.09,0,.19,0,.28-.01,1.93-.15,3.36-1.84,3.21-3.77-.06-.73-1.54-18.08-10.78-35.68-.52-.99-1.05-1.94-1.6-2.89,5.2-.1,13.46.25,22.41,2.61,19.61,5.16,33.2,17.09,40.38,35.44,7.14,18.22,4.07,35.9-9.11,52.55ZM202.16,179.35c.39,0,.77-.15,1.07-.44l2.03-2.04c.58-.59.58-1.54,0-2.12-.59-.59-1.54-.58-2.12,0l-2.04,2.05c-.58.59-.58,1.54,0,2.12.29.29.67.44,1.06.44ZM160.43,325.08c-1.82,1.25-2.28,3.74-1.03,5.56,1.25,1.82,3.74,2.28,5.56,1.03s2.28-3.74,1.03-5.56-3.74-2.28-5.56-1.03ZM150.61,325.08c-1.82,1.25-2.28,3.74-1.03,5.56s3.74,2.28,5.56,1.03c1.82-1.25,2.28-3.74,1.03-5.56s-3.74-2.28-5.56-1.03ZM196.69,178.91c.29.29.67.44,1.06.44s.77-.15,1.07-.44c.58-.59.58-1.54,0-2.12l-2.04-2.03c-.59-.59-1.54-.58-2.12,0-.58.59-.58,1.54,0,2.12l2.05,2.04ZM144.16,185.89c-.09-1.93-1.7-3.44-3.66-3.33-1.93.09-3.42,1.73-3.33,3.66.9,19.48,7.79,36.89,20.48,51.74.69.81,1.67,1.23,2.66,1.23.8,0,1.61-.28,2.27-.84,1.47-1.26,1.64-3.46.39-4.93-11.65-13.64-17.98-29.63-18.81-47.52ZM259.39,182.56c-1.94-.11-3.57,1.4-3.66,3.33-.83,17.89-7.16,33.88-18.81,47.52-1.26,1.47-1.08,3.68.39,4.93.66.56,1.47.84,2.27.84.99,0,1.97-.42,2.66-1.23,12.69-14.85,19.58-32.26,20.48-51.74.09-1.93-1.4-3.57-3.33-3.66ZM203.21,181.2c-.59-.59-1.54-.59-2.12,0-.59.58-.59,1.54,0,2.12l2.05,2.04c.29.29.67.44,1.06.44s.77-.15,1.07-.44c.58-.59.58-1.54,0-2.12l-2.04-2.03ZM198.8,183.32c.58-.59.58-1.54,0-2.12-.59-.59-1.54-.58-2.12,0l-2.04,2.05c-.58.59-.58,1.54,0,2.12.29.29.67.44,1.06.44s.77-.15,1.07-.44l2.03-2.04ZM199.95,192.03c-1.93,0-3.5,1.57-3.5,3.5v36.33c0,1.93,1.57,3.5,3.5,3.5s3.5-1.57,3.5-3.5v-36.33c0-1.93-1.57-3.5-3.5-3.5Z" />
        </svg>
        <ButtonX class="rounded-full p-2" @click="showWindow(0)" />
      </div>
      <nav class="w-full flex flex-col overflow-y-auto">
        <router-link
          v-for="item in menuItems"
          :key="item.name"
          :to="{ name: item.name }"
          class="menu-item mx-auto my-8"
        >{{ item.name }}</router-link>
        <router-link v-if="loggedIn" :to="{ name: 'Profile'}" class="menu-item mx-auto my-8">Profile</router-link>
        <button v-if="!loggedIn" class="menu-item mx-auto my-8 click-outside-ignore" @click="showWindow(2)">Login</button>
        <button v-else class="menu-item mx-auto my-8" @click="useLogout">Logout</button>
      </nav>
    </div>
  </transition>
</template>